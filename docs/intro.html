<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Introduction to Visualization | EDP 5334: Statistical Methods</title>
  <meta name="description" content="Course Description: Elementary method of organizing, analyzing, and interpreting quantitative data, with particular reference to school-related issues. Exercises in the computation of the most commonly employed statistical indices in tabulation, graphic representation, and presentation of data in educational reports. The techniques used are also applicable to other fields." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Introduction to Visualization | EDP 5334: Statistical Methods" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Course Description: Elementary method of organizing, analyzing, and interpreting quantitative data, with particular reference to school-related issues. Exercises in the computation of the most commonly employed statistical indices in tabulation, graphic representation, and presentation of data in educational reports. The techniques used are also applicable to other fields." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Introduction to Visualization | EDP 5334: Statistical Methods" />
  
  <meta name="twitter:description" content="Course Description: Elementary method of organizing, analyzing, and interpreting quantitative data, with particular reference to school-related issues. Exercises in the computation of the most commonly employed statistical indices in tabulation, graphic representation, and presentation of data in educational reports. The techniques used are also applicable to other fields." />
  

<meta name="author" content="R. Noah Padgett" />


<meta name="date" content="2021-01-21" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="references.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-3.5.1/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.3/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">EDP 5334: Statistical Methods</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Course Description</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction to Visualization</a>
<ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#data"><i class="fa fa-check"></i><b>2.1</b> Data</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#basic-principles-of-ggplot2"><i class="fa fa-check"></i><b>2.2</b> Basic principles of <code>{ggplot2}</code></a></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#create-plots-with-ggplot2"><i class="fa fa-check"></i><b>2.3</b> Create plots with <code>{ggplot2}</code></a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="intro.html"><a href="intro.html#scatter-plot"><i class="fa fa-check"></i><b>2.3.1</b> Scatter plot</a></li>
<li class="chapter" data-level="2.3.2" data-path="intro.html"><a href="intro.html#line-plot"><i class="fa fa-check"></i><b>2.3.2</b> Line plot</a></li>
<li class="chapter" data-level="2.3.3" data-path="intro.html"><a href="intro.html#combination-of-line-and-points"><i class="fa fa-check"></i><b>2.3.3</b> Combination of line and points</a></li>
<li class="chapter" data-level="2.3.4" data-path="intro.html"><a href="intro.html#histogram"><i class="fa fa-check"></i><b>2.3.4</b> Histogram</a></li>
<li class="chapter" data-level="2.3.5" data-path="intro.html"><a href="intro.html#density-plot"><i class="fa fa-check"></i><b>2.3.5</b> Density plot</a></li>
<li class="chapter" data-level="2.3.6" data-path="intro.html"><a href="intro.html#combination-of-histogram-and-densities"><i class="fa fa-check"></i><b>2.3.6</b> Combination of histogram and densities</a></li>
<li class="chapter" data-level="2.3.7" data-path="intro.html"><a href="intro.html#boxplot"><i class="fa fa-check"></i><b>2.3.7</b> Boxplot</a></li>
<li class="chapter" data-level="2.3.8" data-path="intro.html"><a href="intro.html#barplot"><i class="fa fa-check"></i><b>2.3.8</b> Barplot</a></li>
<li class="chapter" data-level="2.3.9" data-path="intro.html"><a href="intro.html#further-personalization"><i class="fa fa-check"></i><b>2.3.9</b> Further personalization</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#to-go-further"><i class="fa fa-check"></i><b>2.4</b> To go further</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">EDP 5334: Statistical Methods</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="intro" class="section level1" number="2">
<h1><span class="header-section-number">Chapter 2</span> Introduction to Visualization</h1>
<p>The follow was adapted from <a href="https://statsandr.com/blog/graphics-in-r-with-ggplot2/">Antonie Soetewey’s blog post</a>.</p>
<p>R is known to be a really powerful programming language when it comes to graphics and visualizations.</p>
<p>To keep it short, graphics in R can be done in three ways, via the:</p>
<ol style="list-style-type: decimal">
<li><code>{graphics}</code> package (the base graphics in R, loaded by default)</li>
<li><code>{lattice}</code> package which adds more functionalities to the base package</li>
<li><code>{ggplot2}</code> package</li>
</ol>
<p>The <code>{graphics}</code> package comes with a large choice of plots (such as <code>plot</code>, <code>hist</code>, <code>barplot</code>, <code>boxplot</code>, <code>pie</code>, <code>mosaicplot</code>, etc.) and additional related features (e.g., <code>abline</code>, <code>lines</code>, <code>legend</code>, <code>mtext</code>, <code>rect</code>, etc.). It is often the preferred way to draw plots for most R users, and in particular for beginners to intermediate users.</p>
<p>Since its creation in 2005 by Hadley Wickham, <strong><code>{ggplot2}</code></strong> has grown in use to become one of the most popular R packages and the <strong>most popular package for graphics and data visualizations</strong>. The <code>{ggplot2}</code> package is a much more modern approach to creating professional-quality graphics. More information about the package can be found at <a href="https://ggplot2.tidyverse.org/" target="_blank">ggplot2.tidyverse.org</a>.</p>
<p>In this article, we will see how to create common plots such as scatter plots, line plots, histograms, boxplots, barplots, density plots in R with this package.</p>
<div id="data" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Data</h2>
<p>To illustrate plots with the <code>{ggplot2}</code> package we will use the <code>mpg</code> dataset available in the package. The dataset contains observations collected by the US Environmental Protection Agency on fuel economy from 1999 to 2008 for 38 popular models of cars (run <code>?mpg</code> for more information about the data):</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="intro.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-2"><a href="intro.html#cb1-2" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> ggplot2<span class="sc">::</span>mpg</span></code></pre></div>
<p>Before going further, let’s transform the <code>cyl</code>, <code>drv</code>, <code>fl</code>, <code>year</code> and <code>class</code> variables in with the <code>transform()</code> function:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="intro.html#cb2-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">transform</span>(dat,</span>
<span id="cb2-2"><a href="intro.html#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">cyl =</span> <span class="fu">factor</span>(cyl),</span>
<span id="cb2-3"><a href="intro.html#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">drv =</span> <span class="fu">factor</span>(drv),</span>
<span id="cb2-4"><a href="intro.html#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">fl =</span> <span class="fu">factor</span>(fl),</span>
<span id="cb2-5"><a href="intro.html#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="fu">factor</span>(year),</span>
<span id="cb2-6"><a href="intro.html#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">class =</span> <span class="fu">factor</span>(class)</span>
<span id="cb2-7"><a href="intro.html#cb2-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="basic-principles-of-ggplot2" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> Basic principles of <code>{ggplot2}</code></h2>
<p>The <code>{ggplot2}</code> package is based on the principles of “The Grammar of Graphics” (hence “gg” in the name of <code>{ggplot2}</code>), that is, a coherent system for describing and building graphs. The main idea is to <strong>design a graphic as a succession of layers</strong>.</p>
<p>The main layers are:</p>
<ol style="list-style-type: decimal">
<li>The <strong>dataset</strong> that contains the variables that we want to represent. This is done with the <code>ggplot()</code> function and comes first.</li>
<li>The <strong>variable(s)</strong> to represent on the x and/or y-axis, and the aesthetic elements (such as color, size, fill, shape and transparency) of the objects to be represented. This is done with the <code>aes()</code> function (abbreviation of aesthetic).</li>
<li>The <strong>type of graphical representation</strong> (scatter plot, line plot, barplot, histogram, boxplot, etc.). This is done with the functions <code>geom_point()</code>, <code>geom_line()</code>, <code>geom_bar()</code>, <code>geom_histogram()</code>, <code>geom_boxplot()</code>, etc.</li>
<li>If needed, additional layers (such as labels, annotations, scales, axis ticks, legends, themes, facets, etc.) can be added to personalize the plot.</li>
</ol>
<p>To create a plot, we thus first need to specify the data in the <code>ggplot()</code> function and then add the required layers such as the variables, the aesthetic elements and the type of plot:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="intro.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data) <span class="sc">+</span></span>
<span id="cb3-2"><a href="intro.html#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> var_x, <span class="at">y =</span> var_y) <span class="sc">+</span></span>
<span id="cb3-3"><a href="intro.html#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_x</span>()</span></code></pre></div>
<ul>
<li><code>data</code> in <code>ggplot()</code> is the name of the data frame which contains the variables <code>var_x</code> and <code>var_y</code>.</li>
<li>The <code>+</code> symbol is used to indicate the different layers that will be added to the plot. Make sure to write the <code>+</code> <em>symbol at the end of the line</em> of code and not at the beginning of the line, otherwise R throws an error.</li>
<li>The layer <code>aes()</code> indicates what variables will be used in the plot and more generally, the aesthetic elements of the plot.</li>
<li>Finally, <code>x</code> in <code>geom_x()</code> represents the type of plot.</li>
<li>Other layers are usually not required unless we want to personalize the plot further.</li>
</ul>
<p>Note that it is a good practice to write one line of code per layer to improve code readability.</p>
</div>
<div id="create-plots-with-ggplot2" class="section level2" number="2.3">
<h2><span class="header-section-number">2.3</span> Create plots with <code>{ggplot2}</code></h2>
<p>In the following sections we will show how to draw the following plots:</p>
<ul>
<li>scatter plot</li>
<li>line plot</li>
<li>histogram</li>
<li>density plot</li>
<li>boxplot</li>
<li>barplot</li>
</ul>
<p>In order to focus on the construction of the different plots and the use of <code>{ggplot2}</code>, we will restrict ourselves to drawing basic (yet beautiful) plots without unnecessary layers. For the sake of completeness, we will briefly discuss and illustrate different layers to further personalize a plot at end of this section.</p>
<p>Note that if you still struggle to create plots with <code>{ggplot2}</code> after reading this tutorial, you may find the <code>{esquisse}</code> addin useful.
This addin allows you to <strong>interactively</strong> (that is, by dragging and dropping variables) create plots with the <code>{ggplot2}</code> package. Give it a try!</p>
<div id="scatter-plot" class="section level3" number="2.3.1">
<h3><span class="header-section-number">2.3.1</span> Scatter plot</h3>
<p>We start by creating a scatter plot using <code>geom_point</code>. Remember that a scatter plot is used to visualize the relation between two quantitative variables].</p>
<ol style="list-style-type: decimal">
<li>We start by specifying the data:</li>
</ol>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="intro.html#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat) <span class="co"># data</span></span></code></pre></div>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<ol start="2" style="list-style-type: decimal">
<li>Then we add the variables to be represented with the <code>aes()</code> function:</li>
</ol>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="intro.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat) <span class="sc">+</span> <span class="co"># data</span></span>
<span id="cb5-2"><a href="intro.html#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy) <span class="co"># variables</span></span></code></pre></div>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<ol start="3" style="list-style-type: decimal">
<li>Finally, we indicate the type of plot:</li>
</ol>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="intro.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat) <span class="sc">+</span> <span class="co"># data</span></span>
<span id="cb6-2"><a href="intro.html#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy) <span class="sc">+</span> <span class="co"># variables</span></span>
<span id="cb6-3"><a href="intro.html#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="co"># type of plot</span></span></code></pre></div>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>You will also sometimes see the aesthetic elements (<code>aes()</code> with the variables) inside the <code>ggplot()</code> function in addition to the dataset:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="intro.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb7-2"><a href="intro.html#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>This second method gives the exact same plot than the first method. I tend to prefer the first method over the second for better readability, but this is more a matter of taste so the choice is up to you.</p>
</div>
<div id="line-plot" class="section level3" number="2.3.2">
<h3><span class="header-section-number">2.3.2</span> Line plot</h3>
<p>Line plots, particularly useful in time series or finance, can be created similarly but by using <code>geom_line()</code>:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="intro.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat) <span class="sc">+</span></span>
<span id="cb8-2"><a href="intro.html#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy) <span class="sc">+</span></span>
<span id="cb8-3"><a href="intro.html#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
</div>
<div id="combination-of-line-and-points" class="section level3" number="2.3.3">
<h3><span class="header-section-number">2.3.3</span> Combination of line and points</h3>
<p>An advantage of <code>{ggplot2}</code> is the ability to combine several types of plots and its flexibility in designing it. For instance, we can add a line to a scatter plot by simply adding a layer to the initial scatter plot:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="intro.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat) <span class="sc">+</span></span>
<span id="cb9-2"><a href="intro.html#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy) <span class="sc">+</span></span>
<span id="cb9-3"><a href="intro.html#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb9-4"><a href="intro.html#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="co"># add line</span></span></code></pre></div>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
</div>
<div id="histogram" class="section level3" number="2.3.4">
<h3><span class="header-section-number">2.3.4</span> Histogram</h3>
<p>A histogram (useful to visualize distributions and detect potential outliers can be plotted using <code>geom_histogram()</code>:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="intro.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat) <span class="sc">+</span></span>
<span id="cb10-2"><a href="intro.html#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> hwy) <span class="sc">+</span></span>
<span id="cb10-3"><a href="intro.html#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with
## `binwidth`.</code></pre>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>By default, the number of bins is equal to 30. You can change this value using the <code>bins</code> argument inside the <code>geom_histogram()</code> function:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="intro.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat) <span class="sc">+</span></span>
<span id="cb12-2"><a href="intro.html#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> hwy) <span class="sc">+</span></span>
<span id="cb12-3"><a href="intro.html#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="fu">sqrt</span>(<span class="fu">nrow</span>(dat)))</span></code></pre></div>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>Here I specify the number of bins to be equal to the square root of the number of observations (following Sturge’s rule) but you can specify any numeric value.</p>
</div>
<div id="density-plot" class="section level3" number="2.3.5">
<h3><span class="header-section-number">2.3.5</span> Density plot</h3>
<p>Density plotscan be created using <code>geom_density()</code>:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="intro.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat) <span class="sc">+</span></span>
<span id="cb13-2"><a href="intro.html#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> hwy) <span class="sc">+</span></span>
<span id="cb13-3"><a href="intro.html#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span></code></pre></div>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
<div id="combination-of-histogram-and-densities" class="section level3" number="2.3.6">
<h3><span class="header-section-number">2.3.6</span> Combination of histogram and densities</h3>
<p>We can also superimpose a histogram and a density curve on the same plot:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="intro.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat) <span class="sc">+</span></span>
<span id="cb14-2"><a href="intro.html#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> hwy, <span class="at">y =</span> ..density..) <span class="sc">+</span></span>
<span id="cb14-3"><a href="intro.html#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>() <span class="sc">+</span></span>
<span id="cb14-4"><a href="intro.html#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with
## `binwidth`.</code></pre>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>Or superimpose several densities:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="intro.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat) <span class="sc">+</span></span>
<span id="cb16-2"><a href="intro.html#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> hwy, <span class="at">color =</span> drv, <span class="at">fill =</span> drv) <span class="sc">+</span></span>
<span id="cb16-3"><a href="intro.html#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.25</span>) <span class="co"># add transparency</span></span></code></pre></div>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>The argument <code>alpha = 0.25</code> has been added for some transparency. More information about this argument can be found in at the end.</p>
</div>
<div id="boxplot" class="section level3" number="2.3.7">
<h3><span class="header-section-number">2.3.7</span> Boxplot</h3>
<p>A boxplot (also very useful to visualize distributions and detect potential outliers can be plotted using <code>geom_boxplot()</code>:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="intro.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxplot for one variable</span></span>
<span id="cb17-2"><a href="intro.html#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat) <span class="sc">+</span></span>
<span id="cb17-3"><a href="intro.html#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> hwy) <span class="sc">+</span></span>
<span id="cb17-4"><a href="intro.html#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="intro.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxplot by factor</span></span>
<span id="cb18-2"><a href="intro.html#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat) <span class="sc">+</span></span>
<span id="cb18-3"><a href="intro.html#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> drv, <span class="at">y =</span> hwy) <span class="sc">+</span></span>
<span id="cb18-4"><a href="intro.html#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-17-2.png" width="672" /></p>
<p>It is also possible to plot the points on the boxplot with <code>geom_jitter()</code>, and to vary the width of the boxes according to the size (i.e., the number of observations) of each level with <code>varwidth = TRUE</code>:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="intro.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat) <span class="sc">+</span></span>
<span id="cb19-2"><a href="intro.html#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> drv, <span class="at">y =</span> hwy) <span class="sc">+</span></span>
<span id="cb19-3"><a href="intro.html#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">varwidth =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> <span class="co"># vary boxes width according to n obs.</span></span>
<span id="cb19-4"><a href="intro.html#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">width =</span> <span class="fl">0.2</span>) <span class="co"># adds random noise and limit its width</span></span></code></pre></div>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>The <code>geom_jitter()</code> layer adds some random variation to each point in order to prevent them from overlapping (an issue known as overplotting).<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> Moreover, the <code>alpha</code> argument adds some transparency to the points to keep the focus on the boxes and not on the points.</p>
<p>Finally, it is also possible to divide boxplots into several panels according to the levels of a qualitative variable:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="intro.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat) <span class="sc">+</span></span>
<span id="cb20-2"><a href="intro.html#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> drv, <span class="at">y =</span> hwy) <span class="sc">+</span></span>
<span id="cb20-3"><a href="intro.html#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">varwidth =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> <span class="co"># vary boxes width according to n obs.</span></span>
<span id="cb20-4"><a href="intro.html#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span> <span class="co"># adds random noise and limit its width</span></span>
<span id="cb20-5"><a href="intro.html#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>year) <span class="co"># divide into 2 panels</span></span></code></pre></div>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<p>For a visually more appealing plot, it is also possible to use some colors for the boxes depending on the x variable:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="intro.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat) <span class="sc">+</span></span>
<span id="cb21-2"><a href="intro.html#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> drv, <span class="at">y =</span> hwy, <span class="at">fill =</span> drv) <span class="sc">+</span> <span class="co"># add color to boxes with fill</span></span>
<span id="cb21-3"><a href="intro.html#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">varwidth =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> <span class="co"># vary boxes width according to n obs.</span></span>
<span id="cb21-4"><a href="intro.html#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span> <span class="co"># adds random noise and limit its width</span></span>
<span id="cb21-5"><a href="intro.html#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>year) <span class="sc">+</span> <span class="co"># divide into 2 panels</span></span>
<span id="cb21-6"><a href="intro.html#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="co"># remove legend</span></span></code></pre></div>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<p>In that case, it best to remove the legend as it becomes redundant. See more information about the legend later on.</p>
<p>If you are unhappy with the default colors provided in <code>{ggplot2}</code>, you can change them manually with the <code>scale_fill_manual()</code> layer:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="intro.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat) <span class="sc">+</span></span>
<span id="cb22-2"><a href="intro.html#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> drv, <span class="at">y =</span> hwy, <span class="at">fill =</span> drv) <span class="sc">+</span> <span class="co"># add color to boxes with fill</span></span>
<span id="cb22-3"><a href="intro.html#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">varwidth =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> <span class="co"># vary boxes width according to n obs.</span></span>
<span id="cb22-4"><a href="intro.html#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span> <span class="co"># adds random noise and limit its width</span></span>
<span id="cb22-5"><a href="intro.html#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>year) <span class="sc">+</span> <span class="co"># divide into 2 panels</span></span>
<span id="cb22-6"><a href="intro.html#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span> <span class="co"># remove legend</span></span>
<span id="cb22-7"><a href="intro.html#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;darkred&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;steelblue&quot;</span>)) <span class="co"># change fill color manually</span></span></code></pre></div>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
</div>
<div id="barplot" class="section level3" number="2.3.8">
<h3><span class="header-section-number">2.3.8</span> Barplot</h3>
<p>A barplot (useful to visualize qualitative variables) can be plotted using <code>geom_bar()</code>:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="intro.html#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat) <span class="sc">+</span></span>
<span id="cb23-2"><a href="intro.html#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> drv) <span class="sc">+</span></span>
<span id="cb23-3"><a href="intro.html#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code></pre></div>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<p>By default, the heights of the bars correspond to the observed frequencies for each level of the variable of interest (<code>drv</code> in our case).</p>
<p>Again, for a more appealing plot, we can add some colors to the bars with the <code>fill</code> argument:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="intro.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat) <span class="sc">+</span></span>
<span id="cb24-2"><a href="intro.html#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> drv, <span class="at">fill =</span> drv) <span class="sc">+</span> <span class="co"># add colors to bars</span></span>
<span id="cb24-3"><a href="intro.html#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb24-4"><a href="intro.html#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="co"># remove legend</span></span></code></pre></div>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<p>We can also create a barplot with two qualitative variables:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="intro.html#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat) <span class="sc">+</span></span>
<span id="cb25-2"><a href="intro.html#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> drv, <span class="at">fill =</span> year) <span class="sc">+</span> <span class="co"># fill by years</span></span>
<span id="cb25-3"><a href="intro.html#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code></pre></div>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<p>In order to compare proportions across groups, it is best to make each bar the same height using <code>position = "fill"</code>:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="intro.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat) <span class="sc">+</span></span>
<span id="cb26-2"><a href="intro.html#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> drv, <span class="at">fill =</span> year), <span class="at">position =</span> <span class="st">&quot;fill&quot;</span>)</span></code></pre></div>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<p>To draw the bars next to each other for each group, use <code>position = "dodge"</code>:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="intro.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat) <span class="sc">+</span></span>
<span id="cb27-2"><a href="intro.html#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> drv, <span class="at">fill =</span> year), <span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>)</span></code></pre></div>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
</div>
<div id="further-personalization" class="section level3" number="2.3.9">
<h3><span class="header-section-number">2.3.9</span> Further personalization</h3>
<div id="title-and-axis-labels" class="section level4" number="2.3.9.1">
<h4><span class="header-section-number">2.3.9.1</span> Title and axis labels</h4>
<p>The first things to personalize in a plot is the labels to make the plot more informative to the audience. We can easily add a title, subtitle, caption and edit axis labels with the <code>labs()</code> function:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="intro.html#cb28-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dat) <span class="sc">+</span></span>
<span id="cb28-2"><a href="intro.html#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy) <span class="sc">+</span></span>
<span id="cb28-3"><a href="intro.html#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb28-4"><a href="intro.html#cb28-4" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">labs</span>(</span>
<span id="cb28-5"><a href="intro.html#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">&quot;Fuel efficiency for 38 popular models of car&quot;</span>,</span>
<span id="cb28-6"><a href="intro.html#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">subtitle =</span> <span class="st">&quot;Period 1999-2008&quot;</span>,</span>
<span id="cb28-7"><a href="intro.html#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">&quot;Data: ggplot2::mpg. See more at statsandr.com&quot;</span>,</span>
<span id="cb28-8"><a href="intro.html#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="st">&quot;Engine displacement (litres)&quot;</span>,</span>
<span id="cb28-9"><a href="intro.html#cb28-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="st">&quot;Highway miles per gallon (mpg)&quot;</span></span>
<span id="cb28-10"><a href="intro.html#cb28-10" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
<p>As you can see in the above code, you can save one or more layers of the plot in an object for later use. This way, you can save your “main” plot, and add more layers of personalization until you get the desired output. Here we saved the main scatter plot in an object called <code>p</code> and we will refer to it for the subsequent personalizations.</p>
<p>You can also edit the alignment, the size and the shape of the title and subtitle via the <code>theme()</code> layer and the <code>element_text()</code> function:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="intro.html#cb29-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">labs</span>(</span>
<span id="cb29-2"><a href="intro.html#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">&quot;Fuel efficiency for 38 popular models of car&quot;</span>,</span>
<span id="cb29-3"><a href="intro.html#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">subtitle =</span> <span class="st">&quot;Period 1999-2008&quot;</span>,</span>
<span id="cb29-4"><a href="intro.html#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">&quot;Data: ggplot2::mpg. See more at statsandr.com&quot;</span>,</span>
<span id="cb29-5"><a href="intro.html#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="st">&quot;Engine displacement (litres)&quot;</span>,</span>
<span id="cb29-6"><a href="intro.html#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="st">&quot;Highway miles per gallon (mpg)&quot;</span></span>
<span id="cb29-7"><a href="intro.html#cb29-7" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb29-8"><a href="intro.html#cb29-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb29-9"><a href="intro.html#cb29-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(</span>
<span id="cb29-10"><a href="intro.html#cb29-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="co"># center</span></span>
<span id="cb29-11"><a href="intro.html#cb29-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">size =</span> <span class="dv">12</span>,</span>
<span id="cb29-12"><a href="intro.html#cb29-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">&quot;steelblue&quot;</span>,</span>
<span id="cb29-13"><a href="intro.html#cb29-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">face =</span> <span class="st">&quot;bold&quot;</span></span>
<span id="cb29-14"><a href="intro.html#cb29-14" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb29-15"><a href="intro.html#cb29-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(</span>
<span id="cb29-16"><a href="intro.html#cb29-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="co"># center</span></span>
<span id="cb29-17"><a href="intro.html#cb29-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">size =</span> <span class="dv">10</span>,</span>
<span id="cb29-18"><a href="intro.html#cb29-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">&quot;gray&quot;</span>,</span>
<span id="cb29-19"><a href="intro.html#cb29-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">face =</span> <span class="st">&quot;italic&quot;</span></span>
<span id="cb29-20"><a href="intro.html#cb29-20" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb29-21"><a href="intro.html#cb29-21" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
<p>If the title or subtitle is long and you want to divide it into multiple lines, use <code>\n</code>:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="intro.html#cb30-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">labs</span>(</span>
<span id="cb30-2"><a href="intro.html#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">&quot;Fuel efficiency for 38 popular </span><span class="sc">\n</span><span class="st"> models of car&quot;</span>,</span>
<span id="cb30-3"><a href="intro.html#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">subtitle =</span> <span class="st">&quot;Period 1999-2008&quot;</span>,</span>
<span id="cb30-4"><a href="intro.html#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">&quot;Data: ggplot2::mpg. See more at statsandr.com&quot;</span>,</span>
<span id="cb30-5"><a href="intro.html#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="st">&quot;Engine displacement (litres)&quot;</span>,</span>
<span id="cb30-6"><a href="intro.html#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="st">&quot;Highway miles per gallon (mpg)&quot;</span></span>
<span id="cb30-7"><a href="intro.html#cb30-7" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb30-8"><a href="intro.html#cb30-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb30-9"><a href="intro.html#cb30-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(</span>
<span id="cb30-10"><a href="intro.html#cb30-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="co"># center</span></span>
<span id="cb30-11"><a href="intro.html#cb30-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">size =</span> <span class="dv">12</span>,</span>
<span id="cb30-12"><a href="intro.html#cb30-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">&quot;steelblue&quot;</span>,</span>
<span id="cb30-13"><a href="intro.html#cb30-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">face =</span> <span class="st">&quot;bold&quot;</span></span>
<span id="cb30-14"><a href="intro.html#cb30-14" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb30-15"><a href="intro.html#cb30-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(</span>
<span id="cb30-16"><a href="intro.html#cb30-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="co"># center</span></span>
<span id="cb30-17"><a href="intro.html#cb30-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">size =</span> <span class="dv">10</span>,</span>
<span id="cb30-18"><a href="intro.html#cb30-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">&quot;gray&quot;</span>,</span>
<span id="cb30-19"><a href="intro.html#cb30-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">face =</span> <span class="st">&quot;italic&quot;</span></span>
<span id="cb30-20"><a href="intro.html#cb30-20" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb30-21"><a href="intro.html#cb30-21" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
</div>
<div id="axis-ticks" class="section level4" number="2.3.9.2">
<h4><span class="header-section-number">2.3.9.2</span> Axis ticks</h4>
<p>Axis ticks can be adjusted using <code>scale_x_continuous()</code> and <code>scale_y_continuous()</code> for the x and y-axis, respectively:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="intro.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjust ticks</span></span>
<span id="cb31-2"><a href="intro.html#cb31-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">1</span>, <span class="at">to =</span> <span class="dv">7</span>, <span class="at">by =</span> <span class="fl">0.5</span>)) <span class="sc">+</span> <span class="co"># x-axis</span></span>
<span id="cb31-3"><a href="intro.html#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">10</span>, <span class="at">to =</span> <span class="dv">45</span>, <span class="at">by =</span> <span class="dv">5</span>)) <span class="co"># y-axis</span></span></code></pre></div>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
</div>
<div id="log-transformations" class="section level4" number="2.3.9.3">
<h4><span class="header-section-number">2.3.9.3</span> Log transformations</h4>
<p>In some cases, it is useful to plot the log transformation of the variables. This can be done with the <code>scale_x_log10()</code> and <code>scale_y_log10()</code> functions:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="intro.html#cb32-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb32-2"><a href="intro.html#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>()</span></code></pre></div>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
</div>
<div id="limits" class="section level4" number="2.3.9.4">
<h4><span class="header-section-number">2.3.9.4</span> Limits</h4>
<p>The most convenient way to control the limits of the plot is to use again the <code>scale_x_continuous()</code> and <code>scale_y_continuous()</code> functions in addition to the <code>limits</code> argument:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="intro.html#cb33-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">6</span>)) <span class="sc">+</span></span>
<span id="cb33-2"><a href="intro.html#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">30</span>))</span></code></pre></div>
<pre><code>## Warning: Removed 181 rows containing missing values (geom_point).</code></pre>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-32-1.png" width="672" /></p>
<p>It is also possible to simply take a subset of the dataset with the <code>subset()</code> or <code>filter()</code> function. See how to subset a dataset if you need a reminder.</p>
</div>
<div id="legend" class="section level4" number="2.3.9.5">
<h4><span class="header-section-number">2.3.9.5</span> Legend</h4>
<p>By default, the legend is located to the right side of the plot (when there is a legend to be displayed of course). To control the position of the legend, we need to use the <code>theme()</code> function in addition to the <code>legend.position</code> argument:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="intro.html#cb35-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">color =</span> class) <span class="sc">+</span></span>
<span id="cb35-2"><a href="intro.html#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>)</span></code></pre></div>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
<p>Replace <code>"top"</code> by <code>"left"</code> or <code>"bottom"</code> to change its position and by <code>"none"</code> to remove it.</p>
<p>The title of the legend can be edited with the <code>labs()</code> layer:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="intro.html#cb36-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">color =</span> class) <span class="sc">+</span></span>
<span id="cb36-2"><a href="intro.html#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">&quot;Car&#39;s class&quot;</span>)</span></code></pre></div>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
<p>Note that the argument inside <code>labs()</code> must match the one inside the <code>aes()</code> layer (in this case: <code>color</code>).</p>
<p>The title of the legend can also be removed with <code>legend.title = element_blank()</code> inside the <code>theme()</code> layer:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="intro.html#cb37-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">color =</span> class) <span class="sc">+</span></span>
<span id="cb37-2"><a href="intro.html#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb37-3"><a href="intro.html#cb37-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb37-4"><a href="intro.html#cb37-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span></span>
<span id="cb37-5"><a href="intro.html#cb37-5" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
<p>The legend now appears at the bottom of the plot, without the legend title.</p>
</div>
<div id="shape-color-size-and-transparency" class="section level4" number="2.3.9.6">
<h4><span class="header-section-number">2.3.9.6</span> Shape, color, size and transparency</h4>
<p>There are a very large number of options to improve the quality of the plot or to add additional information. These include:</p>
<ul>
<li>shape,</li>
<li>size,</li>
<li>color, and</li>
<li>alpha (transparency).</li>
</ul>
<p>We can for instance change the shape of all points in a scatter plot by adding <code>shape</code> to <code>geom_point()</code>, or vary the shape according to the values taken by another variable (in that case, the <code>shape</code> argument must be inside <code>aes()</code>):<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a></p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="intro.html#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Change shape of all points</span></span>
<span id="cb38-2"><a href="intro.html#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat) <span class="sc">+</span></span>
<span id="cb38-3"><a href="intro.html#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy) <span class="sc">+</span></span>
<span id="cb38-4"><a href="intro.html#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">4</span>)</span></code></pre></div>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="intro.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Change shape of points based on a categorical variable</span></span>
<span id="cb39-2"><a href="intro.html#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat) <span class="sc">+</span></span>
<span id="cb39-3"><a href="intro.html#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">shape =</span> drv) <span class="sc">+</span></span>
<span id="cb39-4"><a href="intro.html#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-36-2.png" width="672" /></p>
<p>Following the same principle, we can modify the color, size and transparency of the points based on a qualitative or quantitative variable. Here are some examples:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="intro.html#cb40-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dat) <span class="sc">+</span></span>
<span id="cb40-2"><a href="intro.html#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy) <span class="sc">+</span></span>
<span id="cb40-3"><a href="intro.html#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb40-4"><a href="intro.html#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Change color for all points</span></span>
<span id="cb40-5"><a href="intro.html#cb40-5" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;steelblue&quot;</span>)</span></code></pre></div>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="intro.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Change color based on a qualitative variable</span></span>
<span id="cb41-2"><a href="intro.html#cb41-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">color =</span> drv)</span></code></pre></div>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-37-2.png" width="672" /></p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="intro.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Change color based on a quantitative variable</span></span>
<span id="cb42-2"><a href="intro.html#cb42-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">color =</span> cty)</span></code></pre></div>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-37-3.png" width="672" /></p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="intro.html#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Change color based on a criterion (median of cty variable)</span></span>
<span id="cb43-2"><a href="intro.html#cb43-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">color =</span> cty <span class="sc">&gt;</span> <span class="fu">median</span>(cty))</span></code></pre></div>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-37-4.png" width="672" /></p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="intro.html#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Change size of all points</span></span>
<span id="cb44-2"><a href="intro.html#cb44-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>)</span></code></pre></div>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-37-5.png" width="672" /></p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="intro.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Change size of points based on a quantitative variable</span></span>
<span id="cb45-2"><a href="intro.html#cb45-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">size =</span> cty)</span></code></pre></div>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-37-6.png" width="672" /></p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="intro.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Change transparency based on a quantitative variable</span></span>
<span id="cb46-2"><a href="intro.html#cb46-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">alpha =</span> cty)</span></code></pre></div>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-37-7.png" width="672" /></p>
<p>We can of course mix several options (shape, color, size, alpha) to build more complex graphics:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="intro.html#cb47-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb47-2"><a href="intro.html#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">color =</span> drv, <span class="at">shape =</span> year, <span class="at">alpha =</span> cty)</span></code></pre></div>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
<p>If you are unhappy with the default colors, you can change them manually with the <code>scale_colour_manual()</code> layer (for qualitative variables) and the <code>scale_coulour_gradient2()</code> layer (for quantitative variables):</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="intro.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Change color based on a qualitative variable</span></span>
<span id="cb48-2"><a href="intro.html#cb48-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">color =</span> drv) <span class="sc">+</span></span>
<span id="cb48-3"><a href="intro.html#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;green&quot;</span>))</span></code></pre></div>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="intro.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Change color based on a quantitative variable</span></span>
<span id="cb49-2"><a href="intro.html#cb49-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">color =</span> cty) <span class="sc">+</span></span>
<span id="cb49-3"><a href="intro.html#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_gradient2</span>(</span>
<span id="cb49-4"><a href="intro.html#cb49-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">low =</span> <span class="st">&quot;green&quot;</span>,</span>
<span id="cb49-5"><a href="intro.html#cb49-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">mid =</span> <span class="st">&quot;gray&quot;</span>,</span>
<span id="cb49-6"><a href="intro.html#cb49-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">high =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb49-7"><a href="intro.html#cb49-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">midpoint =</span> <span class="fu">median</span>(dat<span class="sc">$</span>cty)</span>
<span id="cb49-8"><a href="intro.html#cb49-8" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-39-2.png" width="672" /></p>
</div>
<div id="text-and-labels" class="section level4" number="2.3.9.7">
<h4><span class="header-section-number">2.3.9.7</span> Text and labels</h4>
<p>To add a label on a point (for example the row number), we can use the <code>geom_text()</code> and <code>aes()</code> functions:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="intro.html#cb50-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">rownames</span>(dat)),</span>
<span id="cb50-2"><a href="intro.html#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">check_overlap =</span> <span class="cn">TRUE</span>,</span>
<span id="cb50-3"><a href="intro.html#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb50-4"><a href="intro.html#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb50-5"><a href="intro.html#cb50-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
<p>To add text on the plot, we use the <code>annotate()</code> function:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="intro.html#cb51-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>,</span>
<span id="cb51-2"><a href="intro.html#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="dv">6</span>,</span>
<span id="cb51-3"><a href="intro.html#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="dv">40</span>,</span>
<span id="cb51-4"><a href="intro.html#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="st">&quot;hwy and displ are </span><span class="sc">\n</span><span class="st"> negatively correlated </span><span class="sc">\n</span><span class="st"> (rho = -0.77, p-value &lt; 0.001)&quot;</span>,</span>
<span id="cb51-5"><a href="intro.html#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">size =</span> <span class="dv">3</span></span>
<span id="cb51-6"><a href="intro.html#cb51-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-41-1.png" width="672" /></p>
</div>
<div id="smooth-and-regression-lines" class="section level4" number="2.3.9.8">
<h4><span class="header-section-number">2.3.9.8</span> Smooth and regression lines</h4>
<p>In a scatter plot, it is possible to add a smooth line fitted to the data:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="intro.html#cb52-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_smooth</span>()</span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-42-1.png" width="672" /></p>
<p>In the context of simple linear regression, it is often the case that the regression line is displayed on the plot. This can be done by adding <code>method = lm</code> (<code>lm</code> stands for linear model) in the <code>geom_smooth()</code> layer:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="intro.html#cb54-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-43-1.png" width="672" /></p>
<p>It is also possible to draw a regression line for each level of a categorical variable:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="intro.html#cb56-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">color =</span> drv, <span class="at">shape =</span> drv) <span class="sc">+</span></span>
<span id="cb56-2"><a href="intro.html#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, <span class="at">se =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-44-1.png" width="672" /></p>
<p>The <code>se = FALSE</code> argument removes the confidence interval around the regression lines.</p>
</div>
<div id="facets" class="section level4" number="2.3.9.9">
<h4><span class="header-section-number">2.3.9.9</span> Facets</h4>
<p><code>facet_grid</code> allows you to divide the same graphic into several panels according to the values of one or two qualitative variables:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="intro.html#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># According to one variable</span></span>
<span id="cb58-2"><a href="intro.html#cb58-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">facet_grid</span>(. <span class="sc">~</span> drv)</span></code></pre></div>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-45-1.png" width="672" /></p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="intro.html#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># According to 2 variables</span></span>
<span id="cb59-2"><a href="intro.html#cb59-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">facet_grid</span>(drv <span class="sc">~</span> year)</span></code></pre></div>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-45-2.png" width="672" /></p>
<p>It is then possible to add a regression line to each facet:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="intro.html#cb60-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">facet_grid</span>(. <span class="sc">~</span> drv) <span class="sc">+</span></span>
<span id="cb60-2"><a href="intro.html#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-46-1.png" width="672" /></p>
</div>
<div id="themes" class="section level4" number="2.3.9.10">
<h4><span class="header-section-number">2.3.9.10</span> Themes</h4>
<p>Several functions are available in the <code>{ggplot2}</code> package to change the theme of the plot. The most common themes after the default theme (i.e., <code>theme_gray()</code>) are the black and white (<code>theme_bw()</code>), minimal (<code>theme_minimal()</code>) and classic (<code>theme_classic()</code>) themes:</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="intro.html#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Black and white theme</span></span>
<span id="cb62-2"><a href="intro.html#cb62-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-47-1.png" width="672" /></p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="intro.html#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Minimal theme</span></span>
<span id="cb63-2"><a href="intro.html#cb63-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-47-2.png" width="672" /></p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="intro.html#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Classic theme</span></span>
<span id="cb64-2"><a href="intro.html#cb64-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-47-3.png" width="672" /></p>
<p>I tend to use the minimal theme for most of my R Markdown reports as it brings out the patterns and points and not the layout of the plot, but again this is a matter of personal taste. See more themes at <a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" target="_blank">ggplot2.tidyverse.org/reference/ggtheme.html</a> and in the <code>{ggthemes}</code> package.</p>
<p>In order to avoid having to change the theme for each plot you create, you can change the theme for the current R session using the <code>theme_set()</code> function as follows:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="intro.html#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_minimal</span>())</span></code></pre></div>
</div>
<div id="interactive-plot-with-plotly" class="section level4" number="2.3.9.11">
<h4><span class="header-section-number">2.3.9.11</span> Interactive plot with <code>{plotly}</code></h4>
<p>You can easily make your plots created with <code>{ggplot2}</code> interactive with the <code>{plotly}</code> package:</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="intro.html#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb66-2"><a href="intro.html#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(p <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">color =</span> year))</span></code></pre></div>
<div id="htmlwidget-7af295d9cb1e2b7d8572" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-7af295d9cb1e2b7d8572">{"x":{"data":[{"x":[1.8,1.8,2.8,2.8,1.8,1.8,2.8,2.8,2.8,5.7,5.7,5.7,5.7,6.5,2.4,3.1,2.4,3,3.3,3.3,3.8,3.8,3.9,3.9,5.2,5.2,3.9,5.2,5.9,5.2,5.2,5.9,4.6,5.4,4,4,4,5,4.2,4.2,4.6,4.6,5.4,3.8,3.8,4.6,4.6,1.6,1.6,1.6,1.6,1.6,2.4,2.4,2.5,2.5,2,2,4,4.7,4,4.6,5.4,5.4,4,5,2.4,2.4,3,3,3.3,3.3,3.1,3.8,3.8,2.5,2.5,2.2,2.2,2.5,2.5,2.7,2.7,3.4,3.4,2.2,2.2,3,3,2.2,2.2,3,3,1.8,1.8,1.8,4.7,2.7,2.7,3.4,3.4,2,2,2.8,1.9,2,2,2.8,2.8,1.9,1.9,2,2,1.8,1.8,2.8,2.8],"y":[29,29,26,26,26,25,25,25,24,17,26,23,15,17,27,26,24,24,22,22,22,21,17,17,17,15,17,16,15,15,16,15,17,17,17,19,17,17,17,17,16,16,15,26,25,21,22,33,32,32,29,32,26,27,26,26,26,29,20,17,15,15,17,16,17,17,29,27,26,25,17,17,26,26,27,25,24,26,26,26,26,20,20,19,17,29,27,26,26,27,29,26,26,30,33,35,15,20,20,17,19,29,26,24,44,29,26,23,24,44,41,29,26,29,29,26,26],"text":["year: 1999<br />displ: 1.8<br />hwy: 29","year: 1999<br />displ: 1.8<br />hwy: 29","year: 1999<br />displ: 2.8<br />hwy: 26","year: 1999<br />displ: 2.8<br />hwy: 26","year: 1999<br />displ: 1.8<br />hwy: 26","year: 1999<br />displ: 1.8<br />hwy: 25","year: 1999<br />displ: 2.8<br />hwy: 25","year: 1999<br />displ: 2.8<br />hwy: 25","year: 1999<br />displ: 2.8<br />hwy: 24","year: 1999<br />displ: 5.7<br />hwy: 17","year: 1999<br />displ: 5.7<br />hwy: 26","year: 1999<br />displ: 5.7<br />hwy: 23","year: 1999<br />displ: 5.7<br />hwy: 15","year: 1999<br />displ: 6.5<br />hwy: 17","year: 1999<br />displ: 2.4<br />hwy: 27","year: 1999<br />displ: 3.1<br />hwy: 26","year: 1999<br />displ: 2.4<br />hwy: 24","year: 1999<br />displ: 3.0<br />hwy: 24","year: 1999<br />displ: 3.3<br />hwy: 22","year: 1999<br />displ: 3.3<br />hwy: 22","year: 1999<br />displ: 3.8<br />hwy: 22","year: 1999<br />displ: 3.8<br />hwy: 21","year: 1999<br />displ: 3.9<br />hwy: 17","year: 1999<br />displ: 3.9<br />hwy: 17","year: 1999<br />displ: 5.2<br />hwy: 17","year: 1999<br />displ: 5.2<br />hwy: 15","year: 1999<br />displ: 3.9<br />hwy: 17","year: 1999<br />displ: 5.2<br />hwy: 16","year: 1999<br />displ: 5.9<br />hwy: 15","year: 1999<br />displ: 5.2<br />hwy: 15","year: 1999<br />displ: 5.2<br />hwy: 16","year: 1999<br />displ: 5.9<br />hwy: 15","year: 1999<br />displ: 4.6<br />hwy: 17","year: 1999<br />displ: 5.4<br />hwy: 17","year: 1999<br />displ: 4.0<br />hwy: 17","year: 1999<br />displ: 4.0<br />hwy: 19","year: 1999<br />displ: 4.0<br />hwy: 17","year: 1999<br />displ: 5.0<br />hwy: 17","year: 1999<br />displ: 4.2<br />hwy: 17","year: 1999<br />displ: 4.2<br />hwy: 17","year: 1999<br />displ: 4.6<br />hwy: 16","year: 1999<br />displ: 4.6<br />hwy: 16","year: 1999<br />displ: 5.4<br />hwy: 15","year: 1999<br />displ: 3.8<br />hwy: 26","year: 1999<br />displ: 3.8<br />hwy: 25","year: 1999<br />displ: 4.6<br />hwy: 21","year: 1999<br />displ: 4.6<br />hwy: 22","year: 1999<br />displ: 1.6<br />hwy: 33","year: 1999<br />displ: 1.6<br />hwy: 32","year: 1999<br />displ: 1.6<br />hwy: 32","year: 1999<br />displ: 1.6<br />hwy: 29","year: 1999<br />displ: 1.6<br />hwy: 32","year: 1999<br />displ: 2.4<br />hwy: 26","year: 1999<br />displ: 2.4<br />hwy: 27","year: 1999<br />displ: 2.5<br />hwy: 26","year: 1999<br />displ: 2.5<br />hwy: 26","year: 1999<br />displ: 2.0<br />hwy: 26","year: 1999<br />displ: 2.0<br />hwy: 29","year: 1999<br />displ: 4.0<br />hwy: 20","year: 1999<br />displ: 4.7<br />hwy: 17","year: 1999<br />displ: 4.0<br />hwy: 15","year: 1999<br />displ: 4.6<br />hwy: 15","year: 1999<br />displ: 5.4<br />hwy: 17","year: 1999<br />displ: 5.4<br />hwy: 16","year: 1999<br />displ: 4.0<br />hwy: 17","year: 1999<br />displ: 5.0<br />hwy: 17","year: 1999<br />displ: 2.4<br />hwy: 29","year: 1999<br />displ: 2.4<br />hwy: 27","year: 1999<br />displ: 3.0<br />hwy: 26","year: 1999<br />displ: 3.0<br />hwy: 25","year: 1999<br />displ: 3.3<br />hwy: 17","year: 1999<br />displ: 3.3<br />hwy: 17","year: 1999<br />displ: 3.1<br />hwy: 26","year: 1999<br />displ: 3.8<br />hwy: 26","year: 1999<br />displ: 3.8<br />hwy: 27","year: 1999<br />displ: 2.5<br />hwy: 25","year: 1999<br />displ: 2.5<br />hwy: 24","year: 1999<br />displ: 2.2<br />hwy: 26","year: 1999<br />displ: 2.2<br />hwy: 26","year: 1999<br />displ: 2.5<br />hwy: 26","year: 1999<br />displ: 2.5<br />hwy: 26","year: 1999<br />displ: 2.7<br />hwy: 20","year: 1999<br />displ: 2.7<br />hwy: 20","year: 1999<br />displ: 3.4<br />hwy: 19","year: 1999<br />displ: 3.4<br />hwy: 17","year: 1999<br />displ: 2.2<br />hwy: 29","year: 1999<br />displ: 2.2<br />hwy: 27","year: 1999<br />displ: 3.0<br />hwy: 26","year: 1999<br />displ: 3.0<br />hwy: 26","year: 1999<br />displ: 2.2<br />hwy: 27","year: 1999<br />displ: 2.2<br />hwy: 29","year: 1999<br />displ: 3.0<br />hwy: 26","year: 1999<br />displ: 3.0<br />hwy: 26","year: 1999<br />displ: 1.8<br />hwy: 30","year: 1999<br />displ: 1.8<br />hwy: 33","year: 1999<br />displ: 1.8<br />hwy: 35","year: 1999<br />displ: 4.7<br />hwy: 15","year: 1999<br />displ: 2.7<br />hwy: 20","year: 1999<br />displ: 2.7<br />hwy: 20","year: 1999<br />displ: 3.4<br />hwy: 17","year: 1999<br />displ: 3.4<br />hwy: 19","year: 1999<br />displ: 2.0<br />hwy: 29","year: 1999<br />displ: 2.0<br />hwy: 26","year: 1999<br />displ: 2.8<br />hwy: 24","year: 1999<br />displ: 1.9<br />hwy: 44","year: 1999<br />displ: 2.0<br />hwy: 29","year: 1999<br />displ: 2.0<br />hwy: 26","year: 1999<br />displ: 2.8<br />hwy: 23","year: 1999<br />displ: 2.8<br />hwy: 24","year: 1999<br />displ: 1.9<br />hwy: 44","year: 1999<br />displ: 1.9<br />hwy: 41","year: 1999<br />displ: 2.0<br />hwy: 29","year: 1999<br />displ: 2.0<br />hwy: 26","year: 1999<br />displ: 1.8<br />hwy: 29","year: 1999<br />displ: 1.8<br />hwy: 29","year: 1999<br />displ: 2.8<br />hwy: 26","year: 1999<br />displ: 2.8<br />hwy: 26"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)"}},"hoveron":"points","name":"1999","legendgroup":"1999","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[2,2,3.1,2,2,3.1,3.1,3.1,4.2,5.3,5.3,5.3,6,6.2,6.2,7,5.3,5.3,2.4,3.5,3.6,3.3,3.3,3.3,3.8,4,3.7,3.7,4.7,4.7,4.7,4.7,4.7,4.7,5.7,4.7,4.7,4.7,4.7,4.7,4.7,5.7,5.4,4,4.6,4.6,5.4,4,4,4.6,4.6,5.4,1.8,1.8,1.8,2,2.4,2.4,3.3,2,2,2.7,2.7,2.7,3,3.7,4.7,4.7,5.7,6.1,4.2,4.4,5.4,4,4.6,2.5,2.5,3.5,3.5,3.5,4,5.6,3.8,5.3,2.5,2.5,2.5,2.5,2.5,2.5,2.5,2.5,4,4.7,2.4,2.4,3.5,2.4,2.4,3.3,1.8,1.8,5.7,2.7,4,4,2,2,2,2,2.5,2.5,2.5,2.5,2,2,3.6],"y":[31,30,27,28,27,25,25,25,23,20,15,20,17,26,25,24,19,14,30,29,26,24,24,17,23,23,19,18,19,19,12,17,12,17,18,16,12,17,17,16,12,17,18,19,19,17,17,26,24,23,22,20,34,36,36,29,30,31,28,28,27,24,24,24,22,19,12,19,18,14,18,18,18,19,19,31,32,27,26,25,20,18,28,25,27,25,26,23,25,27,25,27,20,17,31,31,28,31,31,27,37,35,18,22,18,20,29,29,29,29,29,29,28,29,28,29,26],"text":["year: 2008<br />displ: 2.0<br />hwy: 31","year: 2008<br />displ: 2.0<br />hwy: 30","year: 2008<br />displ: 3.1<br />hwy: 27","year: 2008<br />displ: 2.0<br />hwy: 28","year: 2008<br />displ: 2.0<br />hwy: 27","year: 2008<br />displ: 3.1<br />hwy: 25","year: 2008<br />displ: 3.1<br />hwy: 25","year: 2008<br />displ: 3.1<br />hwy: 25","year: 2008<br />displ: 4.2<br />hwy: 23","year: 2008<br />displ: 5.3<br />hwy: 20","year: 2008<br />displ: 5.3<br />hwy: 15","year: 2008<br />displ: 5.3<br />hwy: 20","year: 2008<br />displ: 6.0<br />hwy: 17","year: 2008<br />displ: 6.2<br />hwy: 26","year: 2008<br />displ: 6.2<br />hwy: 25","year: 2008<br />displ: 7.0<br />hwy: 24","year: 2008<br />displ: 5.3<br />hwy: 19","year: 2008<br />displ: 5.3<br />hwy: 14","year: 2008<br />displ: 2.4<br />hwy: 30","year: 2008<br />displ: 3.5<br />hwy: 29","year: 2008<br />displ: 3.6<br />hwy: 26","year: 2008<br />displ: 3.3<br />hwy: 24","year: 2008<br />displ: 3.3<br />hwy: 24","year: 2008<br />displ: 3.3<br />hwy: 17","year: 2008<br />displ: 3.8<br />hwy: 23","year: 2008<br />displ: 4.0<br />hwy: 23","year: 2008<br />displ: 3.7<br />hwy: 19","year: 2008<br />displ: 3.7<br />hwy: 18","year: 2008<br />displ: 4.7<br />hwy: 19","year: 2008<br />displ: 4.7<br />hwy: 19","year: 2008<br />displ: 4.7<br />hwy: 12","year: 2008<br />displ: 4.7<br />hwy: 17","year: 2008<br />displ: 4.7<br />hwy: 12","year: 2008<br />displ: 4.7<br />hwy: 17","year: 2008<br />displ: 5.7<br />hwy: 18","year: 2008<br />displ: 4.7<br />hwy: 16","year: 2008<br />displ: 4.7<br />hwy: 12","year: 2008<br />displ: 4.7<br />hwy: 17","year: 2008<br />displ: 4.7<br />hwy: 17","year: 2008<br />displ: 4.7<br />hwy: 16","year: 2008<br />displ: 4.7<br />hwy: 12","year: 2008<br />displ: 5.7<br />hwy: 17","year: 2008<br />displ: 5.4<br />hwy: 18","year: 2008<br />displ: 4.0<br />hwy: 19","year: 2008<br />displ: 4.6<br />hwy: 19","year: 2008<br />displ: 4.6<br />hwy: 17","year: 2008<br />displ: 5.4<br />hwy: 17","year: 2008<br />displ: 4.0<br />hwy: 26","year: 2008<br />displ: 4.0<br />hwy: 24","year: 2008<br />displ: 4.6<br />hwy: 23","year: 2008<br />displ: 4.6<br />hwy: 22","year: 2008<br />displ: 5.4<br />hwy: 20","year: 2008<br />displ: 1.8<br />hwy: 34","year: 2008<br />displ: 1.8<br />hwy: 36","year: 2008<br />displ: 1.8<br />hwy: 36","year: 2008<br />displ: 2.0<br />hwy: 29","year: 2008<br />displ: 2.4<br />hwy: 30","year: 2008<br />displ: 2.4<br />hwy: 31","year: 2008<br />displ: 3.3<br />hwy: 28","year: 2008<br />displ: 2.0<br />hwy: 28","year: 2008<br />displ: 2.0<br />hwy: 27","year: 2008<br />displ: 2.7<br />hwy: 24","year: 2008<br />displ: 2.7<br />hwy: 24","year: 2008<br />displ: 2.7<br />hwy: 24","year: 2008<br />displ: 3.0<br />hwy: 22","year: 2008<br />displ: 3.7<br />hwy: 19","year: 2008<br />displ: 4.7<br />hwy: 12","year: 2008<br />displ: 4.7<br />hwy: 19","year: 2008<br />displ: 5.7<br />hwy: 18","year: 2008<br />displ: 6.1<br />hwy: 14","year: 2008<br />displ: 4.2<br />hwy: 18","year: 2008<br />displ: 4.4<br />hwy: 18","year: 2008<br />displ: 5.4<br />hwy: 18","year: 2008<br />displ: 4.0<br />hwy: 19","year: 2008<br />displ: 4.6<br />hwy: 19","year: 2008<br />displ: 2.5<br />hwy: 31","year: 2008<br />displ: 2.5<br />hwy: 32","year: 2008<br />displ: 3.5<br />hwy: 27","year: 2008<br />displ: 3.5<br />hwy: 26","year: 2008<br />displ: 3.5<br />hwy: 25","year: 2008<br />displ: 4.0<br />hwy: 20","year: 2008<br />displ: 5.6<br />hwy: 18","year: 2008<br />displ: 3.8<br />hwy: 28","year: 2008<br />displ: 5.3<br />hwy: 25","year: 2008<br />displ: 2.5<br />hwy: 27","year: 2008<br />displ: 2.5<br />hwy: 25","year: 2008<br />displ: 2.5<br />hwy: 26","year: 2008<br />displ: 2.5<br />hwy: 23","year: 2008<br />displ: 2.5<br />hwy: 25","year: 2008<br />displ: 2.5<br />hwy: 27","year: 2008<br />displ: 2.5<br />hwy: 25","year: 2008<br />displ: 2.5<br />hwy: 27","year: 2008<br />displ: 4.0<br />hwy: 20","year: 2008<br />displ: 4.7<br />hwy: 17","year: 2008<br />displ: 2.4<br />hwy: 31","year: 2008<br />displ: 2.4<br />hwy: 31","year: 2008<br />displ: 3.5<br />hwy: 28","year: 2008<br />displ: 2.4<br />hwy: 31","year: 2008<br />displ: 2.4<br />hwy: 31","year: 2008<br />displ: 3.3<br />hwy: 27","year: 2008<br />displ: 1.8<br />hwy: 37","year: 2008<br />displ: 1.8<br />hwy: 35","year: 2008<br />displ: 5.7<br />hwy: 18","year: 2008<br />displ: 2.7<br />hwy: 22","year: 2008<br />displ: 4.0<br />hwy: 18","year: 2008<br />displ: 4.0<br />hwy: 20","year: 2008<br />displ: 2.0<br />hwy: 29","year: 2008<br />displ: 2.0<br />hwy: 29","year: 2008<br />displ: 2.0<br />hwy: 29","year: 2008<br />displ: 2.0<br />hwy: 29","year: 2008<br />displ: 2.5<br />hwy: 29","year: 2008<br />displ: 2.5<br />hwy: 29","year: 2008<br />displ: 2.5<br />hwy: 28","year: 2008<br />displ: 2.5<br />hwy: 29","year: 2008<br />displ: 2.0<br />hwy: 28","year: 2008<br />displ: 2.0<br />hwy: 29","year: 2008<br />displ: 3.6<br />hwy: 26"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,191,196,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,191,196,1)"}},"hoveron":"points","name":"2008","legendgroup":"2008","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.2283105022831,"r":7.30593607305936,"b":40.1826484018265,"l":37.2602739726027},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[1.33,7.27],"tickmode":"array","ticktext":["2","3","4","5","6","7"],"tickvals":[2,3,4,5,6,7],"categoryorder":"array","categoryarray":["2","3","4","5","6","7"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"displ","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[10.4,45.6],"tickmode":"array","ticktext":["20","30","40"],"tickvals":[20,30,40],"categoryorder":"array","categoryarray":["20","30","40"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"hwy","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":0.96751968503937},"annotations":[{"text":"year","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"25c07f805adb":{"colour":{},"x":{},"y":{},"type":"scatter"}},"cur_data":"25c07f805adb","visdat":{"25c07f805adb":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>You can now hover over a point to display more information about that point. There is also the possibility to zoom in and out, to download the plot, to select some observations, etc. More information about <code>{plotly}</code> for R can be found <a href="https://plotly.com/r/" target="_blank">here</a>.</p>
</div>
<div id="combine-plots-with-patchwork" class="section level4" number="2.3.9.12">
<h4><span class="header-section-number">2.3.9.12</span> Combine plots with <code>{patchwork}</code></h4>
<p>There are several ways to combine plots made in <code>{ggplot2}</code>. In my opinion, the most convenient way is with the <code>{patchwork}</code> package using symbols such as <code>+</code>, <code>/</code> and parentheses.</p>
<p>We first need to create some plots and save them:</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="intro.html#cb67-1" aria-hidden="true" tabindex="-1"></a>p_a <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dat) <span class="sc">+</span></span>
<span id="cb67-2"><a href="intro.html#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy) <span class="sc">+</span></span>
<span id="cb67-3"><a href="intro.html#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb67-4"><a href="intro.html#cb67-4" aria-hidden="true" tabindex="-1"></a>p_b <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dat) <span class="sc">+</span></span>
<span id="cb67-5"><a href="intro.html#cb67-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> hwy) <span class="sc">+</span></span>
<span id="cb67-6"><a href="intro.html#cb67-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()</span>
<span id="cb67-7"><a href="intro.html#cb67-7" aria-hidden="true" tabindex="-1"></a>p_c <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dat) <span class="sc">+</span></span>
<span id="cb67-8"><a href="intro.html#cb67-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> drv, <span class="at">y =</span> hwy) <span class="sc">+</span></span>
<span id="cb67-9"><a href="intro.html#cb67-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p>Now that we have 3 plots saved in our environment, we can combine them. To have plots <strong>next to each other</strong> simply use the <code>+</code> symbol:</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="intro.html#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb68-2"><a href="intro.html#cb68-2" aria-hidden="true" tabindex="-1"></a>p_a <span class="sc">+</span> p_b <span class="sc">+</span> p_c</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with
## `binwidth`.</code></pre>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-51-1.png" width="672" /></p>
<p>To display them <strong>above each other</strong> simply use the <code>/</code> symbol:</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="intro.html#cb70-1" aria-hidden="true" tabindex="-1"></a>p_a <span class="sc">/</span> p_b <span class="sc">/</span> p_c</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with
## `binwidth`.</code></pre>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-52-1.png" width="672" /></p>
<p>And finally, to combine them <strong>above and next</strong> to each other, mix <code>+</code>, <code>/</code> and parentheses:</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="intro.html#cb72-1" aria-hidden="true" tabindex="-1"></a>p_a <span class="sc">+</span> p_b <span class="sc">/</span> p_c</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with
## `binwidth`.</code></pre>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-53-1.png" width="672" /></p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="intro.html#cb74-1" aria-hidden="true" tabindex="-1"></a>(p_a <span class="sc">+</span> p_b) <span class="sc">/</span> p_c</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with
## `binwidth`.</code></pre>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-53-2.png" width="672" /></p>
<p>See more ways to combine plots with:</p>
<ul>
<li><code>grid.arrange()</code> from the <code>{gridExtra}</code> package</li>
<li><code>plot_grid()</code> from the <code>{cowplot}</code> package</li>
</ul>
</div>
<div id="flip-coordinates" class="section level4" number="2.3.9.13">
<h4><span class="header-section-number">2.3.9.13</span> Flip coordinates</h4>
<p>Flipping coordinates of your plot is useful to create horizontal boxplots, or when labels of a variable are so long that they overlap each other on the x-axis. See with and without flipping coordinates below:</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="intro.html#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># without flipping coordinates</span></span>
<span id="cb76-2"><a href="intro.html#cb76-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dat) <span class="sc">+</span></span>
<span id="cb76-3"><a href="intro.html#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> class, <span class="at">y =</span> hwy) <span class="sc">+</span></span>
<span id="cb76-4"><a href="intro.html#cb76-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span>
<span id="cb76-5"><a href="intro.html#cb76-5" aria-hidden="true" tabindex="-1"></a><span class="co"># with flipping coordinates</span></span>
<span id="cb76-6"><a href="intro.html#cb76-6" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dat) <span class="sc">+</span></span>
<span id="cb76-7"><a href="intro.html#cb76-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> class, <span class="at">y =</span> hwy) <span class="sc">+</span></span>
<span id="cb76-8"><a href="intro.html#cb76-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb76-9"><a href="intro.html#cb76-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span>
<span id="cb76-10"><a href="intro.html#cb76-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb76-11"><a href="intro.html#cb76-11" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="co"># left: without flipping, right: with flipping</span></span></code></pre></div>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-54-1.png" width="672" /></p>
<p>This can be done with many types of plot, not only with boxplots. For instance, if a categorical variable has many levels or the labels are long, it is usually best to flip the coordinates for a better visual:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="intro.html#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat) <span class="sc">+</span></span>
<span id="cb77-2"><a href="intro.html#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> class) <span class="sc">+</span></span>
<span id="cb77-3"><a href="intro.html#cb77-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb77-4"><a href="intro.html#cb77-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-55-1.png" width="672" /></p>
</div>
<div id="save-plot" class="section level4" number="2.3.9.14">
<h4><span class="header-section-number">2.3.9.14</span> Save plot</h4>
<p>The <code>ggsave()</code> function will save the most recent plot in your current working directory unless you specify a path to another folder:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="intro.html#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat) <span class="sc">+</span></span>
<span id="cb78-2"><a href="intro.html#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy) <span class="sc">+</span></span>
<span id="cb78-3"><a href="intro.html#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb78-4"><a href="intro.html#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;plot1.pdf&quot;</span>)</span></code></pre></div>
<p>You can also specify the width, height and resolution (<code>dpi</code>) as follows:</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="intro.html#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;plot1.pdf&quot;</span>,</span>
<span id="cb79-2"><a href="intro.html#cb79-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">12</span>,</span>
<span id="cb79-3"><a href="intro.html#cb79-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">12</span>,</span>
<span id="cb79-4"><a href="intro.html#cb79-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>,</span>
<span id="cb79-5"><a href="intro.html#cb79-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">dpi =</span> <span class="dv">300</span></span>
<span id="cb79-6"><a href="intro.html#cb79-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="managing-dates" class="section level4" number="2.3.9.15">
<h4><span class="header-section-number">2.3.9.15</span> Managing dates</h4>
<p>If the time variable in your dataset is in date format, the <code>{ggplot2}</code> package recognizes the date format and automatically uses a specific type for the axis ticks.</p>
<p>There is no time variable with a date format in our dataset, so let’s create a new variable of this type thanks to the <code>as.Date()</code> function:</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="intro.html#cb80-1" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">&quot;2020-08-21&quot;</span>) <span class="sc">-</span> <span class="dv">0</span><span class="sc">:</span>(<span class="fu">nrow</span>(dat) <span class="sc">-</span> <span class="dv">1</span>)</span></code></pre></div>
<p>See the first 6 observations of this date variable and its class:</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="intro.html#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dat<span class="sc">$</span>date)</span></code></pre></div>
<pre><code>## [1] &quot;2020-08-21&quot; &quot;2020-08-20&quot; &quot;2020-08-19&quot; &quot;2020-08-18&quot;
## [5] &quot;2020-08-17&quot; &quot;2020-08-16&quot;</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="intro.html#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dat<span class="sc">$</span>date)</span></code></pre></div>
<pre><code>##  Date[1:234], format: &quot;2020-08-21&quot; &quot;2020-08-20&quot; &quot;2020-08-19&quot; &quot;2020-08-18&quot; ...</code></pre>
<p>The new variable <code>date</code> is correctly specified in a date format.</p>
<p>Most of the time, with a time variable, we want to create a line plot with the date on the X-axis and another continuous variable on the Y-axis, like the following plot for example:</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="intro.html#cb85-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dat) <span class="sc">+</span></span>
<span id="cb85-2"><a href="intro.html#cb85-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> hwy) <span class="sc">+</span></span>
<span id="cb85-3"><a href="intro.html#cb85-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span>
<span id="cb85-4"><a href="intro.html#cb85-4" aria-hidden="true" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-60-1.png" width="672" /></p>
<p>As soon as the time variable is recognized as a date, we can use the <code>scale_x_date()</code> layer to change the format displayed on the X-axis. The following table shows the most frequent date formats:</p>
<p>Run <code>?strptime()</code> to see many more date formats available in R.</p>
<p>For this example, let’s add the year in addition to the unabbreviated month:</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="intro.html#cb86-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">scale_x_date</span>(<span class="at">date_labels =</span> <span class="st">&quot;%B %Y&quot;</span>)</span></code></pre></div>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-61-1.png" width="672" /></p>
<p>It also possible to control the breaks to display on the X-axis with the <code>date_breaks</code> argument. For this example, let’s say we want to display the day as number and the abbreviated month for each interval of 10 days:</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="intro.html#cb87-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">scale_x_date</span>(<span class="at">date_breaks =</span> <span class="st">&quot;10 days&quot;</span>, <span class="at">date_labels =</span> <span class="st">&quot;%d %b&quot;</span>)</span></code></pre></div>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-62-1.png" width="672" /></p>
<p>If labels displayed on the X-axis are unreadable because they overlap each other, you can rotate them with the <code>theme()</code> layer and the <code>angle</code> argument:</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="intro.html#cb88-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">scale_x_date</span>(<span class="at">date_breaks =</span> <span class="st">&quot;10 days&quot;</span>, <span class="at">date_labels =</span> <span class="st">&quot;%d %b&quot;</span>) <span class="sc">+</span></span>
<span id="cb88-2"><a href="intro.html#cb88-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">60</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code></pre></div>
<p><img src="edp5334-statistics_files/figure-html/unnamed-chunk-63-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="to-go-further" class="section level2" number="2.4">
<h2><span class="header-section-number">2.4</span> To go further</h2>
<p>By now you have seen that <code>{ggplot2}</code> is a very powerful and complete package to create plots in R. This article illustrated only the tip of the iceberg, and you will find many tutorials on how to create more advanced plots and visualizations with <code>{ggplot2}</code> online. If you want to learn more than what is described in the present article, I highly recommend starting with:</p>
<ul>
<li>the chapters <a href="https://r4ds.had.co.nz/data-visualisation.html" target="_blank">Data visualisation</a> and <a href="https://r4ds.had.co.nz/graphics-for-communication.html" target="_blank">Graphics for communication</a> from the book <a href="https://r4ds.had.co.nz/" target="_blank">R for Data Science</a> from Garrett Grolemund and Hadley Wickham</li>
<li>the book <a href="https://ggplot2-book.org/" target="_blank">ggplot2: Elegant Graphics for Data Analysis</a> from Hadley Wickham</li>
<li>the book <a href="https://r-graphics.org/" target="_blank">R Graphics Cookbook</a> from Winston Chang</li>
<li>the <a href="https://exts.ggplot2.tidyverse.org/gallery/" target="_blank">ggplot2 extensions guide</a> which lists many of the packages that extend <code>{ggplot2}</code>.</li>
</ul>
<p>Thanks for reading. I hope this article helped you to create your first plots with the <code>{ggplot2}</code> package. As a reminder, for simple graphs, it is sometimes easier to draw them via the <code>{esquisse}</code> addin. After some time, you will quickly learn how to create them by yourselves and in no time you will be able to build complex and sophisticated data visualizations.</p>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>Use the <code>geom_jitter()</code> layer with caution because, although it makes a plot more revealing at large scales, it also makes it slightly less accurate at small scales since some randomness is added to the points.<a href="intro.html#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>There are (at the time of writing) 26 shapes accepted in the <code>shape</code> argument. See this <a href="https://ggplot2.tidyverse.org/reference/aes_linetype_size_shape.html" target="_blank">documentation</a> for all available shapes.<a href="intro.html#fnref2" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["edp5334-statistics.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
